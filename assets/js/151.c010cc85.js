(window.webpackJsonp=window.webpackJsonp||[]).push([[151],{580:function(v,_,t){"use strict";t.r(_);var a=t(55),P=Object(a.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h1",{attrs:{id:"互联网运行原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#互联网运行原理"}},[v._v("#")]),v._v(" 互联网运行原理")]),v._v(" "),t("p",[v._v('互联网（internet），又称国际网络，指的是网络与网络之间所串连成的庞大网络，这些网络以一组通用的协议相连，形成逻辑上的单一巨大国际网络。这一系列通用协议，总称为"互联网协议"（Internet Protocol Suite）。它们对计算机如何连接和组网，做出了详尽的规定。理解了这些协议，就理解了互联网的原理。')]),v._v(" "),t("h2",{attrs:{id:"互联网的分层"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#互联网的分层"}},[v._v("#")]),v._v(" 互联网的分层")]),v._v(" "),t("p",[v._v("互联网的实现，分成好几层，每一层都有自己的功能，用户接触到的，只是最上面的一层，分层的标准有多种，如下：")]),v._v(" "),t("ul",[t("li",[v._v("因特网五层协议栈: 物理层、数据链路层、网络层、传输层、应用层")]),v._v(" "),t("li",[v._v("TCP/IP 四层协议: 网络访问层、网际层、传输层、应用层")]),v._v(" "),t("li",[v._v("OSI 七层模型: 物理层、数据链路层、网络层、传输层、会话层、表示层、应用层")])]),v._v(" "),t("p",[v._v("虽然层数不同，但其实质是将某些层分开或者合并，个人认为，因特网五层协议栈最容易理解。")]),v._v(" "),t("h2",{attrs:{id:"物理层"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#物理层"}},[v._v("#")]),v._v(" 物理层")]),v._v(" "),t("p",[v._v("负责连接计算机，用光缆、电缆、双绞线、无线电波等传送 0 和 1 的电信号")]),v._v(" "),t("h2",{attrs:{id:"数据链路层"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据链路层"}},[v._v("#")]),v._v(" 数据链路层")]),v._v(" "),t("p",[v._v("物理层传递的 0 和 1 没有任何意义，必须规定解读方式：多少个电信号算一组？每个信号位有何意义？数据链路层负责将这些信号分组封装成帧。")]),v._v(" "),t("p",[v._v('市场上电信号分组的协议中，以太网协议占据主导地位，规定一组电信号构成一个数据包，叫做"帧"（Frame），每一帧分成两个部分：标头（Head）和数据（Data）。')]),v._v(" "),t("ul",[t("li",[v._v("标头：包含数据包的一些说明项，比如发送者、接受者、数据类型等等")]),v._v(" "),t("li",[v._v("数据：则是数据包的具体内容")])]),v._v(" "),t("p",[v._v("标头包含发送者和接受者的信息，那么，发送者和接受者是如何标识呢？")]),v._v(" "),t("p",[v._v('以太网规定，连入网络的所有设备，都必须具有"网卡"接口。数据包必须是从一块网卡，传送到另一块网卡。网卡的地址，就是数据包的发送地址和接收地址，这叫做 MAC 地址')]),v._v(" "),t("blockquote",[t("p",[v._v("每块网卡出厂的时候，都有一个全世界独一无二的 MAC 地址，长度是48个二进制位，通常用12个十六进制数表示，前6个十六进制数是厂商编号，后6个是该厂商的网卡流水号")])]),v._v(" "),t("p",[v._v("那一块网卡如何知道另一块网卡的MAC地址呢？答案是使用 ARP 协议，后面细讲。")]),v._v(" "),t("p",[v._v('有了对方的 MAC 地址，以太网采用一种很原始的方式，就是将数据包向本网络内所有计算机发送数据包，让每台计算机自己判断，是否为接收方。其实质就是"广播"（broadcasting）')]),v._v(" "),t("blockquote",[t("p",[v._v('有了数据包的定义、网卡的MAC地址、广播的发送方式，"数据链路层"就可以在多台计算机之间传送数据啦')])]),v._v(" "),t("h2",{attrs:{id:"网络层"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#网络层"}},[v._v("#")]),v._v(" 网络层")]),v._v(" "),t("p",[v._v("负责路由以及把分组报文发送给目标网络或主机")]),v._v(" "),t("p",[v._v('互联网是无数子网络共同组成的一个巨型网络，如果两台设备不在用一个子网络，那采用广播的方式无法获取对方的 MAC 地址。网络层由此诞生，它的作用是引进一套新的地址，使得能够区分不同的设备是否属于同一个子网络。这套地址就叫做"网络地址"，简称"网址"。')]),v._v(" "),t("p",[v._v("至此，每台计算机有了两种地址，一种是MAC地址，另一种是网络地址。两种地址之间没有任何联系，MAC地址是绑定在网卡上的，网络地址则是管理员分配的，它们只是随机组合在一起。")]),v._v(" "),t("blockquote",[t("p",[v._v("网络地址帮助我们确定计算机所在的子网络，MAC地址则将数据包送到该子网络中的目标网卡。因此，从逻辑上可以推断，必定是先处理网络地址，然后再处理MAC地址。")])]),v._v(" "),t("p",[v._v('互联网上的每一台计算机，都会分配到一个IP地址。这个地址分成两个部分，前一部分代表网络，后一部分代表主机，单单从IP地址，无法判断计算机是否在一个子网络。因此，引入另一个参数"子网掩码"（subnet mask），它表示子网络特征的一个参数。')]),v._v(" "),t("p",[v._v("将任意两个IP地址与子网掩码分别进行AND运算，比较结果是否相同，如果是的话，就表明它们在同一个子网络，也是其IP的网络部分")]),v._v(" "),t("blockquote",[t("p",[v._v("IP协议的作用主要有两个，一个是为每一台计算机分配IP地址，另一个是确定哪些地址在同一个子网络。")])]),v._v(" "),t("p",[v._v('通过IP协议发送的数据，就叫做IP数据包，IP数据包和以太网数据包一样，也分为"标头"和"数据"两个部分，IP数据包的头主要包括版本、长度、IP地址等信息。为了解藕，将整个IP数据包作为以太网数据包的数据部分。')]),v._v(" "),t("p",[v._v("关于 ARP 协议的说明，因为IP数据包是放在以太网数据包里发送的，所以我们必须同时知道两个地址，一个是对方的MAC地址，另一个是对方的IP地址。通常情况下，对方的IP地址是已知的（如通过DNS解析域名获得），但是不知道它的MAC地址。因此需要一种机制来获得，这分为两种情况：")]),v._v(" "),t("ol",[t("li",[v._v('两台计算机不在一个子网络。事实上，这样是没有办法得到对方的MAC地址的，只能把数据包传送到两个子网络连接处的"网关"（gateway），让网关去处理。')]),v._v(" "),t("li",[v._v('两台计算机在一个子网络。使用 ARP 协议也是发出一个数据包（包含在以太网数据包中），其中包含它所要查询主机的IP地址，在对方的MAC地址这一栏，填的是FF:FF:FF:FF:FF:FF，表示这是一个"广播"地址。它所在子网络的每一台主机，都会收到这个数据包，从中取出IP地址，与自身的IP地址进行比较。如果两者相同，都做出回复，向对方报告自己的MAC地址，否则就丢弃这个包。')])]),v._v(" "),t("blockquote",[t("p",[v._v("由此，有了 MAC 地址和 IP 地址，我们已经可以在互联网上任意两台主机上建立通信。")])]),v._v(" "),t("h2",{attrs:{id:"传输层"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#传输层"}},[v._v("#")]),v._v(" 传输层")]),v._v(" "),t("p",[v._v('同一台主机上有许多程序都需要用到网络，为了数据区分，还需要一个参数来表示这个数据包到底供哪个程序（进程）使用。这个参数就叫做"端口"（port），它其实是每一个使用网卡的程序的编号。每个数据包都发到主机的特定端口，所以不同的程序就能取到自己所需要的数据。')]),v._v(" "),t("blockquote",[t("p",[v._v('"端口"是0到65535之间的一个整数，正好16个二进制位。0到1023的端口被系统占用，用户只能选用大于1023的端口。不管是浏览网页还是在线聊天，应用程序会随机选用一个端口，然后与服务器的相应端口联系。')])]),v._v(" "),t("p",[v._v('传输层的功能，就是建立"端口到端口"的通信。相比之下，网络层的功能是建立主机到主机的通信。只要确定主机和端口，我们就能实现程序之间的交流')]),v._v(" "),t("p",[v._v('根据安全性、可靠性或复杂度，传输层衍生出两大协议，TCP/UDP 协议，用的较多的 TCP 协议会单独讲，它们有个共同点就是，为了解藕，TCP 数据包或者 UDP 数据包也分为，"标头"部分，主要定义了发出端口和接收端口和"数据"部分，就是具体的内容。作为 IP 数据包的数据部分。')]),v._v(" "),t("h2",{attrs:{id:"应用层"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#应用层"}},[v._v("#")]),v._v(" 应用层")]),v._v(" "),t("p",[v._v('应用程序收到"传输层"的数据，接下来就要进行解读。由于互联网是开放架构，数据来源五花八门，必须事先规定好格式，否则根本无法解读。所以，"应用层"的作用，就是规定应用程序的数据格式。')]),v._v(" "),t("p",[v._v("例如 HTTP、FTP、Telnet、DNS、SMTP 等应用程序协议就构成了应用层，这是最高的一层，直接面对用户，它们的数据就放在了 TCP/UDP 数据包的数据部分。")]),v._v(" "),t("h2",{attrs:{id:"总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[v._v("#")]),v._v(" 总结")]),v._v(" "),t("p",[v._v("网络通信就是交换数据包，在以太网协议下，分享的就是以太网数据包，其数据部分为 IP 数据包，IP 数据包的数据部分为传输层协议 TCP/UDP 数据包，TCP/UDP 数据包的数据部分为应用层协议组成的应用数据，一次层次嵌套，深度解藕，互不影响。")]),v._v(" "),t("p",[v._v("一台计算机加入一个子网络中，需要设置一下四个参数才能联网：")]),v._v(" "),t("ol",[t("li",[v._v("本机的IP地址")]),v._v(" "),t("li",[v._v("子网掩码")]),v._v(" "),t("li",[v._v("网关的IP地址")]),v._v(" "),t("li",[v._v("DNS的IP地址")])]),v._v(" "),t("p",[v._v('但为了灵活方便，一般使用动态 IP 地址上网，所谓动态就是自动分配 IP 地址，该过程使用应用层 DHCP 协议，该协议建立在UDP协议之上，协议规定，每一个子网络中，有一台计算机负责管理本网络的所有IP地址，它叫做"DHCP服务器"。新的计算机加入网络，必须向"DHCP服务器"发送一个"DHCP请求"数据包，申请IP地址和相关的网络参数。过程如下：')]),v._v(" "),t("ol",[t("li",[v._v("以太网数据包标头设置本机的 MAC 地址和接受方的 MAC 地址，前者已知，后者填入一个广播地址：FF-FF-FF-FF-FF-FF")]),v._v(" "),t("li",[v._v("IP 数据包标头设置发出方的IP地址和接收方的IP地址，两者都不知，于是，发出方的IP地址就设为0.0.0.0，接收方的IP地址设为255.255.255.255")]),v._v(" "),t("li",[v._v("UDP 数据包标头设置发出方的端口和接收方的端口，这一部分是DHCP协议规定好的，发出方是68端口，接收方是67端口")])]),v._v(" "),t("p",[v._v('通过广播的方式发送，当 DHCP 服务器看到发出方IP地址是0.0.0.0，接收方是255.255.255.255，于是知道"这个包是发给自己的"，而其他计算机就可以丢弃这个包，接下来，DHCP服务器读取包的数据内容，分配好IP地址，发送回去一个"DHCP响应"数据包。这个响应包的结构也是类似的，以太网数据包标头的MAC地址是双方的网卡地址，IP数据包标头的IP地址是DHCP服务器的IP地址（发出方）和255.255.255.255（接收方），UDP标头的端口是67（发出方）和68（接收方），分配给请求端的IP地址和本网络的具体参数则包含在Data部分。')]),v._v(" "),t("p",[v._v("新加入的计算机收到这个响应包，于是就知道了自己的IP地址、子网掩码、网关地址、DNS服务器等等参数。于是一台计算机正式通过动态 IP 地址的方式接入该子网络，可以愉快的上网了。")])])}),[],!1,null,null,null);_.default=P.exports}}]);